/*
 * STM32F446RE_SPI_DRIVERS.c
 *
 * Created on: Oct 21, 2025
 * Author: notty
 */

// <-- FIX: Corrected include to match the corrected header file name
#include "STM32F446RE_SPI_DRIVERS.h"
#include "stm32f446re.h" // Note: " " is usually for local headers, < > for system
                        // but "stm32f446re.h" will work since it's in your project

void SPI_PeriClockControl(SPI_RegDef_t *pSPIx,uint8_t EiorDi){
	if (EiorDi == ENABLE)
	    {
	        if (pSPIx == SPI1) { SPI1_PCLK_EN(); }
	        else if (pSPIx == SPI2) { SPI2_PCLK_EN(); }
	        // --- FIX: Corrected typo SPI13 to SPI3 ---
	        else if (pSPIx == SPI3) { SPI3_PCLK_EN(); }
	        else if (pSPIx == SPI4) { SPI4_PCLK_EN(); }

	    }
	    else
	    {
	         // --- FIX: Corrected copy-paste error, was _EN() ---
	    	 if (pSPIx == SPI1) { SPI1_PCLK_DI(); }
	    		        else if (pSPIx == SPI2) { SPI2_PCLK_DI(); }
	    		        // --- FIX: Corrected typo SPI13 to SPI3 ---
	    		        else if (pSPIx == SPI3) { SPI3_PCLK_DI(); }
	    		        else if (pSPIx == SPI4) { SPI4_PCLK_DI(); }

	    }
}

// --- FIX: Added pointer (*) to SPI_Handle to match .h file ---
void SPI_Init(SPI_Handle_t *SPI_Handle){
   uint32_t TEMP;
   TEMP|=SPI_Handle->SPI_Config->SPI_DeviceMode<<SPI_CR1_MSTR ;
   if(SPI_Handle->SPI_Config->BusConfig==SPI_BUS_CONFIG_FD)
   {
	   TEMP&=~(1<<SPI_CR1_BIDIMODE);
   }
   else if(SPI_Handle->SPI_Config->BusConfig==SPI_BUS_CONFIG_HD)
   {
	   TEMP|=(1<<SPI_CR1_BIDIMODE);
   }
   else if(SPI_Handle->SPI_Config->BusConfig==SPI_BUS_CONFIG_S_RXONLY)
   {
	   TEMP|=(1<<SPI_CR1_BIDIMODE);
	   TEMP|=(1<<SPI_CR1_RXONLY);

   }
   TEMP|=(SPI_Handle->SPI_Config->SCLK_Speed<<SPI_CR1_BR ;

   TEMP|=(SPI_Handle->SPI_Config->DFF<< SPI_CR1_DFF;
   TEMP|=(SPI_Handle->SPI_Config->CPOL<<SPI_CR1_CPOL;
   TEMP|=(SPI_Handle->SPI_Config->CPHA<<SPI_CR1_CPHA ;

   SPI_Handle->PSPIx->SPI_CR1=TEMP;

}

void SPI_Dinit(SPI_RegDef_t *SPIx){
    // This function is not yet implemented
}

// --- FIX: Changed prototypes to empty function definitions ---
void SPI_SendData(SPI_RegDef_t *pSPIx,uint8_t *pTxBuffer,uint32_t Len){
    // This function is not yet implemented
}
void SPI_ReceiveData(SPI_RegDef_t *pSPIx,uint8_t *pRxBuffer,uint32_t Len){
    // This function is not yet implemented
}

void SPI_IRQConfig(uint8_t IRQNumber, uint8_t EnOrDi){
    // This function is not yet implemented
}
void SPI_IRQPriorityConfig(uint8_t IRQNumber, uint8_t IRQPriority){
    // This function is not yet implemented
}
void SPI_IRQHandling(SPI_Handle_t *SPI_Handle){
    // This function is not yet implemented
}
